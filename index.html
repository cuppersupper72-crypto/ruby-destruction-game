<!DOCTYPE html>
<html>
<head>
  <title>Ruby Saga Revolution</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial;
      text-align: center;
      background: black;
      color: white;
      padding: 20px;
      transition: background 0.5s;
    }

    #ruby {
      font-size: 70px;
      margin: 20px;
    }

    .shake { animation: shake 0.3s infinite; }
    @keyframes shake {
      0% { transform: translate(2px,2px); }
      50% { transform: translate(-2px,-3px); }
      100% { transform: translate(2px,-2px); }
    }

    .flash { animation: flash 0.2s infinite alternate; }
    @keyframes flash {
      from { background: black; }
      to { background: purple; }
    }

    .element {
      display: inline-block;
      padding: 10px;
      margin: 5px;
      background: crimson;
      border-radius: 8px;
      cursor: pointer;
    }

    .house {
      font-size: 40px;
      cursor: pointer;
      margin: 10px;
    }

    #buildZone {
      border: 3px dashed white;
      padding: 20px;
      margin: 20px auto;
      width: 250px;
      display: none;
    }
  </style>
</head>
<body>

<h1>ğŸ’ Ruby Saga Revolution</h1>
<div id="ruby">ğŸ’</div>
<h3>Tap Two Elements To Combine</h3>
<div id="elements"></div>
<p id="message">The ruby feels unstoppable...</p>

<script>
let inventory = ["fire","energy","gravity","dark","water"];
let selected = [];
let suppliesCollected = 0;
let armyCount = 0;
let rayBuilt = false;

function renderElements(){
  const container = document.getElementById("elements");
  container.innerHTML="";
  inventory.forEach(el=>{
    const div=document.createElement("div");
    div.className="element";
    div.innerText=el;
    div.onclick=()=>selectElement(el);
    container.appendChild(div);
  });
}

function selectElement(el){
  selected.push(el);
  document.getElementById("message").innerText=
    "Selected: "+selected.join(" + ");
  if(selected.length===2){
    combine();
    selected=[];
  }
}

function combine(){
  const combo=selected.sort().join("-");

  if(combo==="fire-water") addElement("steam");
  else if(combo==="fire-gravity") addElement("lava");
  else if(combo==="lava-water") addElement("obsidian");
  else if(combo==="water-gravity") addElement("wave");
  else if(combo==="energy-fire") addElement("plasma");
  else if(combo==="dark-gravity") addElement("blackhole");
  else if(combo==="energy-plasma") addElement("supercharge");
  else if(combo==="blackhole-supercharge") destroyRuby();
  else document.getElementById("message").innerText="Nothing formed...";
}

function addElement(newEl){
  if(!inventory.includes(newEl)){
    inventory.push(newEl);
    document.getElementById("message").innerText=
      "New element: "+newEl;
    renderElements();
  }
}

function destroyRuby(){
  const ruby=document.getElementById("ruby");
  ruby.classList.add("shake");
  document.body.classList.add("flash");
  document.getElementById("message").innerText=
    "The Ruby destabilizes...";

  setTimeout(()=>{
    ruby.classList.remove("shake");
    document.body.classList.remove("flash");
    ruby.innerText="ğŸ’¥";
    document.getElementById("message").innerText=
      "A portal opens!";
    setTimeout(nextPlanet,2000);
  },3000);
}

function nextPlanet(){
  document.body.style.background="darkblue";
  document.getElementById("ruby").innerText="ğŸª";
  document.getElementById("elements").innerHTML="";
  document.getElementById("message").innerText=
    "ğŸ¤– The robots are watching... Build a ray gun!";

  inventory=["metal","crystal","energy"];
  renderElements();

  document.body.innerHTML+=`
    <div id="buildZone">Drop Supplies Here</div>
    <div id="armySection" style="display:none;">
      <h3>Recruit The Revolution</h3>
      <div>
        <span class="house" onclick="recruit()">ğŸ </span>
        <span class="house" onclick="recruit()">ğŸ </span>
        <span class="house" onclick="recruit()">ğŸ </span>
      </div>
      <p id="armyCount"></p>
      <button onclick="fightRobots()">Fight Robots</button>
      <p id="final"></p>
    </div>
  `;

  enableBuildZone();
}

function enableBuildZone(){
  const zone=document.getElementById("buildZone");
  zone.style.display="block";
}

function selectElement(el){
  selected.push(el);
  if(selected.length===2){
    if(inventory.includes("metal") && !rayBuilt){
      suppliesCollected++;
      document.getElementById("message").innerText=
        "Supplies added... The robots are watching.";
      selected=[];
      if(suppliesCollected>=2) buildRayGun();
    } else {
      combine();
      selected=[];
    }
  }
}

function buildRayGun(){
  rayBuilt=true;
  document.getElementById("message").innerText=
    "âš™ï¸ Assembling Ray Gun...";
  setTimeout(()=>{
    document.getElementById("message").innerText=
      "ğŸ”« Ray Gun Complete!";
    document.getElementById("armySection").style.display="block";
  },3000);
}

function recruit(){
  armyCount++;
  document.getElementById("armyCount").innerText=
    "Army Size: "+armyCount;
}

function fightRobots(){
  if(rayBuilt && armyCount>=3){
    document.getElementById("final").innerText=
      "âš”ï¸ With your Ray Gun and army, the robots fall. The planet is saved!";
  } else {
    document.getElementById("final").innerText=
      "You need a Ray Gun and more people!";
  }
}

renderElements();
</script>
</body>
</html>